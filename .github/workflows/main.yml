const login = require('@xaviabot/fca-unofficial');
const fs = require('fs');

// সরাসরি কোডে ইমেইল ও পাসওয়ার্ড বসানো হয়েছে
const credentials = {
  email: "mdsabbira0011@gmail.com",
  password: "SABBIRVAI1122"
};

login(credentials, (err, api) => {
  if (err) {
    switch (err.error) {
      case 'login-approval':
        console.log("⚠️  Two-factor authentication enabled. Please approve the login.");
        break;
      default:
        console.error("❌ Login Error:", err);
    }
    return;
  }

  console.log("✅ Login Success");

  // Session file সংরক্ষণ
  fs.writeFileSync('appstate.json', JSON.stringify(api.getAppState()));

  // মেসেজ শোনা শুরু
  api.listenMqtt((err, message) => {
    if (err) return console.error("🔴 Listen Error:", err);
    console.log("🔔 New Message:", message);
  });
});
